"use strict";const e=require("../../../../common/vendor.js"),t=require("./version.js");function n(t,n={}){const o="boundingClientRect",{context:i,type:c=o}=n;return new Promise(((n,a)=>{const r=e.index.createSelectorQuery().in(i).select(t),s=e=>{e?n(e):a()};c==o?r[c](s).exec():r[c]({node:!0,size:!0,rect:!0},s).exec()}))}exports.useCanvas=function(o,i){const{context:c}=i,a=t.canIUseCanvas2d(),r=e.ref();return e.onMounted((()=>{a?n(o,{context:c,type:"fields"}).then((e=>{if(e){const{pixelRatio:n}=t.getSystemInfoSync(),{bottom:o,width:i,height:c,left:a,node:s}=e;s.width=i*n,s.height=c*n;const d=s.getContext("2d");d.scale(n,n),r.value={bottom:o,width:i,height:c,left:a,getContext:()=>d,requestAnimationFrame:s.requestAnimationFrame,cancelAnimationFrame:s.cancelAnimationFrame}}})):n(o,{context:c}).then((t=>{if(t){e.index.createCanvasContext(o.replace("#",""),c);const{bottom:n,width:i,height:a,left:s}=t;r.value={bottom:n,width:i,height:a,left:s,getContext:()=>e.index.createCanvasContext(o.replace("#",""),c)}}}))})),e.computed((()=>r.value))};
